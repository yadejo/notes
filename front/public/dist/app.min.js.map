{"version":3,"sources":["app/app.ts","login/login.ts","notes/notes.ts","register/register.ts","shared/authInterceptorService.ts","shared/authService.ts","templates.ts"],"names":["myApp","angular","module","config","$stateProvider","$urlRouterProvider","$httpProvider","state","url","template","authenticate","params","email","otherwise","interceptors","push","run","$rootScope","$state","authService","$on","event","toState","toParams","fromState","fromParams","name","isLoggedIn","transitionTo","preventDefault","MainCtrl","$scope","this","$inject","controller","app","login","LoginCtrl","username","directive","templateUrl","controllerAs","notes","notes_1","NotesCtrl","notesService","$http","_this","onCheck","note","noteContainer","setTimeout","IsComplete","removeNote","ID","$apply","Notes","filter","n","addNote","newNote","Content","then","response","data","Note","addContainer","newContainerName","container","NoteContainer","Name","removeContainer","length","confirm","loadNotes","JSON","stringify","parse","NotesService","toastr","apiBase","get","post","success","error","containerId","content","noteId","factory","instance","Array","register","RegisterCtrl","executeValidateEmail","registration","Email","validMail","validateEmail","showMailValidation","validate","pw","Password","pwC","ConfirmPassword","canRegister","re","test","$watch","intercept","AuthInterceptorService","$q","localStorageService","$injector","request","headers","authData","Authorization","token","responseError","rejection","status","console","log","logout","go","reject","shared","AuthService","serviceBase","loggedIn","userName","substring","indexOf","password","deferred","defer","Content-Type","set","access_token","resolve","error_description","promise","modelState","ModelState","errorArr","Object","keys","remove","$templateCache","put"],"mappings":"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","file":"app.min.js","sourcesContent":["/// <reference path=\"../../../typings/index.d.ts\" />\r\n\r\nvar myApp = angular.module('notesApp', [\r\n    'app.login',\r\n    'app.register',\r\n    'app.templates',\r\n    'app.notes',\r\n    'app.intercept',\r\n    'ui.router',\r\n    'app.shared',\r\n    'angular-loading-bar',\r\n    'ngAnimate'\r\n]).config(function($stateProvider, $urlRouterProvider, $httpProvider){\r\n    $stateProvider\r\n        .state(\"notes\", {\r\n            url: \"/notes\",\r\n            template: '<notes></notes>',\r\n            authenticate:true\r\n        })\r\n        .state(\"login\", {\r\n            url: \"/login\",\r\n            template: '<login></login>',\r\n            authenticate:false,\r\n            params:{\r\n                email:\"\"\r\n            }\r\n        })\r\n        .state(\"register\", {\r\n            url:\"/register\",\r\n            template: '<register></register>',\r\n            authenticate:false\r\n        });\r\n\r\n        $urlRouterProvider.otherwise(\"/login\");\r\n        $httpProvider.interceptors.push(\"authInterceptorService\");\r\n\r\n\r\n}).run(function($rootScope, $state, authService){\r\n    $rootScope.$on(\"$stateChangeStart\", function(event, toState, toParams, fromState, fromParams){\r\n\r\n            if((toState.name ===\"register\" || toState.name === \"login\" )&& authService.isLoggedIn()){\r\n                $state.transitionTo(\"notes\");\r\n                event.preventDefault();\r\n            }\r\n        \r\n            if(toState.authenticate && !authService.isLoggedIn()){\r\n                $state.transitionTo(\"login\");\r\n                event.preventDefault();\r\n            }      \r\n\r\n    });\r\n});\r\n\r\n\r\n class MainCtrl  {\r\n        static $inject = [\"$scope\", \"authService\"];\r\n        constructor(\r\n            public $scope: ng.IScope,\r\n            public authService: any\r\n        ){}\r\n\r\n    }\r\n\r\n     myApp\r\n         .controller(\"mainCtrl\", MainCtrl);","/// <reference path=\"../../../typings/index.d.ts\" />\r\n\r\nmodule app.login {\r\n\r\n    'use strict';\r\n\r\n    export interface ILoginCtrl {}\r\n\r\n    export interface ILoginScope extends ng.IScope{\r\n        username: string;\r\n    }\r\n\r\n    export class LoginCtrl implements ILoginCtrl {\r\n        static $inject = [\"$scope\", \"authService\", \"$state\"];\r\n        constructor(\r\n            public $scope: ILoginScope,\r\n            public authService: any,\r\n            public $state: any\r\n        ){\r\n            var email: string = $state.params.email;\r\n\r\n            if(email){\r\n                $scope.username = email;\r\n            }\r\n\r\n\r\n        }\r\n    }\r\n\r\n    angular\r\n        .module('app.login', [])\r\n        .directive(\"login\", function(): ng.IDirective {\r\n            return {\r\n                templateUrl: 'app-templates/login/login.html',\r\n                controller:  LoginCtrl,\r\n                controllerAs: 'loginVM'\r\n            };\r\n        })\r\n        .controller(\"loginCtrl\", LoginCtrl);\r\n}\r\n","/// <reference path=\"../../../typings/index.d.ts\" />\r\n\r\nmodule app.notes {\r\n\r\n    export interface INotesCtrl { }\r\n\r\n    export interface INotesScope extends ng.IScope {\r\n        notes: Array<INoteContainer>;\r\n        newContainerName: string;\r\n    }\r\n\r\n    export class NotesCtrl implements INotesCtrl {\r\n        static $inject = [\"$scope\", \"notesService\", \"$http\"];\r\n\r\n        constructor(\r\n            public $scope: INotesScope,\r\n            public notesService: NotesService,\r\n            public $http: ng.IHttpService\r\n        ) {\r\n            var notes = notesService.loadNotes().then((response:any)=>{\r\n                var data = JSON.stringify(response.data);                \r\n                let notes: Array<INoteContainer> = JSON.parse(data);\r\n                $scope.notes = notes;\r\n            });\r\n        }\r\n\r\n        onCheck = (note: Note, noteContainer: NoteContainer) => {\r\n            setTimeout(() => {\r\n                if (note.IsComplete) {                    \r\n                    this.notesService.removeNote(noteContainer.ID, note.ID);\r\n                    this.$scope.$apply(function () {\r\n                        \r\n                        noteContainer.Notes = noteContainer.Notes.filter((n) => { return n.ID != note.ID });\r\n                    });\r\n                }\r\n            }, 3000)\r\n\r\n\r\n        }\r\n\r\n        addNote = (noteContainer: NoteContainer) => {\r\n            if(!noteContainer.newNote) return;\r\n            if (noteContainer.newNote.Content) {\r\n                this.notesService.addNote(noteContainer.ID, noteContainer.newNote.Content).then((response:any) =>{\r\n                    \r\n                noteContainer.newNote.ID = response.data;\r\n                noteContainer.Notes.push(noteContainer.newNote)\r\n                noteContainer.newNote = new Note();\r\n                });\r\n\r\n                \r\n            }\r\n\r\n        }\r\n\r\n        addContainer = () => {\r\n            if (this.$scope.newContainerName) {             \r\n                this.notesService.addContainer(this.$scope.newContainerName).then((response:any) => {\r\n                    var container = new NoteContainer()\r\n                    container.ID = response.data;\r\n                    container.Name = this.$scope.newContainerName;\r\n\r\n                    this.$scope.notes.push(container);\r\n                    this.$scope.newContainerName = \"\";\r\n                });\r\n               \r\n            }\r\n        }\r\n\r\n        removeContainer = (noteContainer: NoteContainer) => {\r\n            if (noteContainer.Notes.length != 0) {\r\n                if (confirm(\"Do you really want to delete this container\")) {\r\n                    this.notesService.removeContainer(noteContainer.ID);\r\n                    this.$scope.notes = this.$scope.notes.filter((n) => { return n.ID != noteContainer.ID });\r\n\r\n                }\r\n            }\r\n            else {\r\n                this.notesService.removeContainer(noteContainer.ID);\r\n                this.$scope.notes = this.$scope.notes.filter((n) => { return n.ID != noteContainer.ID });\r\n            }\r\n        }\r\n    } \r\n\r\n    export interface INotesService {\r\n        loadNotes();\r\n        addContainer(name : string) : number;\r\n    }\r\n    export class NotesService  {\r\n\r\n        apiBase : string =\"http://notes.zawada.be/\"\r\n\r\n        constructor(public $http: ng.IHttpService, public toastr: any){\r\n\r\n        }\r\n\r\n        loadNotes= () => {\r\n            \r\n             return this.$http.get(this.apiBase + \"api/note\", null);\r\n        \r\n        }\r\n\r\n        addContainer = (name: string) =>{\r\n            return this.$http.post(this.apiBase + \"api/note?name=\" + name, null).success((response:any)=>{\r\n                return response;\r\n            }).error((response:any)=>{\r\n                this.toastr.error(\"Container was not created\", \"Error\");\r\n            });\r\n        }\r\n\r\n        addNote = (containerId: number, content: string) =>{\r\n            return this.$http.post(this.apiBase + \"api/note/\" + containerId + \"?todo=\" + content, null).success((response:any)=>{\r\n                return response;\r\n            }).error((response:any)=>{\r\n                this.toastr.error(\"Container was not created\", \"Error\");\r\n            });\r\n        }\r\n\r\n        removeNote = (containerId: number, noteId:number)=>{\r\n            this.$http.delete(this.apiBase + \"api/note/\" + containerId + \"/\" + noteId, null);\r\n        }\r\n\r\n        removeContainer = (containerId : number) =>{\r\n            this.$http.delete(this.apiBase + \"api/note/\" + containerId, null).then((response:any)=>{\r\n\r\n            })\r\n        }\r\n\r\n\r\n        static factory(){\r\n            var instance = ($http: ng.IHttpService, toastr: any) => new NotesService($http, toastr);\r\n\r\n            return instance;\r\n        }\r\n    }\r\n\r\n    class NoteContainer implements INoteContainer{\r\n        ID: number;\r\n        Name: string;\r\n        Notes: Array<Note>;\r\n        newNote: Note;\r\n\r\n        constructor(){\r\n            this.Notes = new Array<Note>();\r\n            this.newNote = new Note();\r\n        }\r\n\r\n\r\n    }\r\n\r\n    interface INoteContainer{\r\n        ID:number;\r\n        Name:string;\r\n        Notes: Array<INote>;        \r\n    }\r\n\r\n    interface INote{\r\n        ID:number;\r\n        IsComplete:boolean;\r\n        Content:string;\r\n    }\r\n\r\n    class Note implements INote{\r\n        ID: number;\r\n        IsComplete: boolean;\r\n        Content: string;\r\n    }\r\n\r\n    angular\r\n        .module('app.notes', ['toastr'])\r\n        .directive(\"notes\", function (): ng.IDirective {\r\n            return {\r\n                templateUrl: 'app-templates/notes/notes.html',\r\n                controller: NotesCtrl,\r\n                controllerAs: 'notesVM'\r\n            };\r\n        })\r\n        .controller(\"notesCtrl\", NotesCtrl)\r\n        .factory(\"notesService\", NotesService.factory());\r\n}\r\n","/// <reference path=\"../../../typings/index.d.ts\" />\r\n\r\n// import {Registration} from '../models/Registration';\r\n\r\nmodule app.register {\r\n\r\n    'use strict';\r\n\r\n    export interface IRegisterCtrl {}\r\n\r\n    export interface IRegisterScope extends ng.IScope{\r\n        register(registration: any):void;\r\n        registration: any;\r\n        canRegister:boolean;\r\n        validMail:boolean;\r\n        showMailValidation: boolean;\r\n    }\r\n\r\n    export class RegisterCtrl implements IRegisterCtrl {\r\n        static $inject = [\"$scope\", \"authService\"];\r\n        constructor(\r\n            public $scope: IRegisterScope,\r\n            public authService: any\r\n        ){            \r\n            $scope.register = (registration: any) =>{\r\n                authService.register(registration);\r\n            }\r\n\r\n            $scope.$watch('registration.Password', ()=>{\r\n               this.validate();\r\n            });\r\n\r\n            $scope.$watch('registration.ConfirmPassword', ()=>{\r\n                this.validate();\r\n            })\r\n\r\n        }\r\n\r\n        executeValidateEmail = () =>{\r\n            var email: string = this.$scope.registration.Email;\r\n            \r\n            this.$scope.validMail = this.validateEmail(email);\r\n\r\n            this.$scope.showMailValidation = !this.$scope.validMail;\r\n        }\r\n\r\n        validate = () =>{\r\n            if(!this.$scope.registration) return false;\r\n\r\n            var pw: string = this.$scope.registration.Password;\r\n            var pwC:string = this.$scope.registration.ConfirmPassword;\r\n            var email: string = this.$scope.registration.Email;\r\n\r\n            this.$scope.validMail = this.validateEmail(email);\r\n\r\n            this.$scope.showMailValidation = !this.$scope.validMail;\r\n\r\n            this.$scope.canRegister = ((pw === pwC) && (pw.length >= 6) && ( this.$scope.validMail));\r\n        }\r\n\r\n        validateEmail= (email):boolean => {\r\n            var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n            return re.test(email);\r\n        }\r\n        \r\n         \r\n        \r\n    }\r\n\r\n    angular\r\n        .module('app.register', [])\r\n        .directive(\"register\", function(): ng.IDirective {\r\n            return {\r\n                templateUrl: 'app-templates/register/register.html',\r\n                controller:  RegisterCtrl,\r\n                controllerAs: 'registerVM'\r\n            };\r\n        });\r\n}\r\n","/// <reference path=\"../../../typings/index.d.ts\" />\r\n\r\n\r\nmodule app.intercept{\r\n    export class AuthInterceptorService{\r\n\r\n        constructor(public $q: ng.IQService, public localStorageService: any, public $injector:any){\r\n\r\n        }\r\n\r\n        public request = (config:any) =>{\r\n            config.headers = config.headers || {};\r\n\r\n            var authData = this.localStorageService.get('authorizationData');\r\n\r\n            if(authData){\r\n                config.headers.Authorization = 'Bearer ' + authData.token;\r\n            }\r\n\r\n            return config;\r\n        }\r\n\r\n        public responseError = (rejection: any) =>{\r\n            if(rejection.status===401){\r\n                var authData = this.localStorageService.get('authorizationData');\r\n                var authService = this.$injector.get('authService');\r\n                var state = this.$injector.get('$state');\r\n\r\n               if(authData){\r\n                console.log('nope');                   \r\n               }\r\n\r\n               authService.logout();\r\n               state.go('login');\r\n               \r\n            }\r\n            return this.$q.reject(rejection);\r\n    }\r\n\r\n\r\n        static factory(){\r\n            var instance = ($q: ng.IQService, localStorageService: any, $injector: any) => new AuthInterceptorService($q, localStorageService, $injector);\r\n\r\n            return instance;\r\n        }\r\n    }\r\n\r\n\r\n    angular\r\n        .module('app.intercept', ['LocalStorageModule'])\r\n        .factory(\"authInterceptorService\", AuthInterceptorService.factory());\r\n}","/// <reference path=\"../../../typings/index.d.ts\" />\r\n\r\n\r\nmodule app.shared{\r\n\r\n    export interface IAuthService{\r\n        isLoggedIn(): boolean;\r\n        login(username: string, password: string): ng.IPromise<{}>;\r\n        logout(): void;\r\n        register(registration: any): any;\r\n    }\r\n\r\n    export class AuthService implements IAuthService{\r\n        private serviceBase: string = \"http://notes.zawada.be/\"\r\n        loggedIn: boolean = false;\r\n    \r\n \r\n        static $inject = [\"$http\", \"$q\", \"localStorageService\", \"toastr\", \"$state\"];\r\n\r\n        constructor(public $http: ng.IHttpService, public $q: ng.IQService, \r\n            public localStorageService: any, public toastr: any, public $state:any){\r\n\r\n        }\r\n\r\n        isLoggedIn = () =>{\r\n           var authData = this.localStorageService.get('authorizationData');\r\n\r\n            if(authData)\r\n                return true;\r\n            else\r\n                return false;\r\n        }\r\n\r\n        userName = () =>{\r\n            var authData = this.localStorageService.get('authorizationData');\r\n            \r\n            if(authData){\r\n                var email: string = authData.username;\r\n                return email.substring(0, email.indexOf(\"@\"));\r\n            }\r\n        }   \r\n\r\n        login = (username: string, password: string) => {\r\n            var data = \"grant_type=password&username=\"+username+\"&password=\" + password;\r\n\r\n            var deferred = this.$q.defer();\r\n            \r\n            this.$http.post(this.serviceBase + 'token', data, {headers: {'Content-Type': 'application/x-www-form-urlencoded'}})\r\n                .success((response:any): void =>{\r\n               \r\n                    this.loggedIn = true;\r\n                    this.localStorageService.set('authorizationData', {token: response.access_token, username: username})\r\n\r\n                    this.$state.go(\"notes\");\r\n                    this.toastr.success(\"You were logged in\", \"Success\");\r\n                    deferred.resolve(response);\r\n                }).error((response:any) : void=>{\r\n                    if(!response){\r\n                        this.toastr.error(\"Server must be down...\", \"Error\");\r\n                    }\r\n                    else{\r\n                        this.toastr.error(response.error_description, \"Error\");\r\n                    }\r\n                    console.log(response);\r\n                    this.logout();\r\n                });\r\n             \r\n             return deferred.promise;\r\n        }\r\n\r\n        register = (registration: any) => {\r\n            this.logout();\r\n            this.$http.post(this.serviceBase + \"api/account/register\", registration, {headers: {'Content-Type': 'application/json'}}).success((response:any) : void=>{\r\n                this.toastr.success(\"Redirecting you to login...\", \"Registration successful\");\r\n                setTimeout(()=>{\r\n                    this.$state.go(\"login\", {email: registration.Email});\r\n                }, 3000)\r\n            }).error((response:any):void=>{\r\n                var modelState = response.ModelState;\r\n                var errorArr = modelState[Object.keys(modelState)[0]];\r\n                this.toastr.error(errorArr[1], \"Error\");\r\n            });\r\n        }\r\n\r\n        logout = () =>{\r\n            this.localStorageService.remove('authorizationData');\r\n\r\n            this.loggedIn = false;\r\n        }\r\n\r\n        static factory(){\r\n            var instance = ($http: ng.IHttpService, $q: ng.IQService, localStorageService: any, toastr: any, $state:any) => new AuthService($http, $q, localStorageService, toastr, $state);\r\n\r\n            return instance;\r\n        }\r\n             \r\n    }\r\n\r\nangular\r\n        .module('app.shared', ['LocalStorageModule', 'toastr'])\r\n        .factory(\"authService\", AuthService.factory());\r\n}",null]}